#!/usr/bin/env bash
# runs all bleanser jobs

set -o pipefail
set -e

main() {
	local default_args args
	mkdir -p ~/.cache/removed
	default_args=(--move ~/.cache/removed)
	for sort_type in size name; do
		args=("${default_args[@]}")
		args+=(--sort-by "$sort_type")
		for bash_dirs in ~/data/bash ~/data/bash_history; do
			python3 -m bleanser_sean.modules.bash prune "${bash_dirs}" "${default_args[@]}"
		done
		for chess_glob in ~/data/chess/chessdotcom_2'*' ~/data/chess/lichess_2'*'; do
			python3 -m bleanser_sean.modules.chess prune --glob "${chess_glob}" "${default_args[@]}"
		done
		python3 -m bleanser_sean.modules.trakt prune --glob ~/data/trakt/2'*' "${default_args[@]}"
		python3 -m bleanser_sean.modules.listenbrainz prune --glob ~/data/listenbrainz/2'*' "${default_args[@]}"
		python3 -m bleanser_sean.modules.zsh prune ~/data/zsh_history "${default_args[@]}"
		python3 -m bleanser_sean.modules.ipython prune ~/data/ipython "${default_args[@]}"
	done
}

main || exit $?
